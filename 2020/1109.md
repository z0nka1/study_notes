## Virtual DOM

虚拟DOM就是一个JS对象，是对真实DOM的描述

因为它只是一个JS对象，所以可以跨平台使用，例子：React/React Native

虚拟DOM通过diff算法，计算出前后两个状态之间的差异，只对变化了的地方进行patch（打补丁）

在多次状态更新之间，一些中间状态往往是无用的，反而导致频繁的reflow/repaint，虚拟DOM通过缓存多次状态变化进行batch（批量）更新来避免这个问题

<br>

虚拟DOM VS. 模板引擎

模板引擎本质上就是字符串拼接，更新DOM的方式是一次性销毁重建，因此，模板引擎具有以下特点：

1. 拼接字符串阶段，简单快速；更新DOM阶段，效率比较低
2. 如果大范围操作DOM，效率还可以接受；但是如果多次小范围操作DOM，资源浪费严重

因此，虚拟DOM对比模板引擎：

在JS代码层面，模板引擎拼接字符串较简单，耗时短，对比虚拟DOM的diff算法（存在递归、循环等耗时操作），模板引擎胜出
在更新DOM层面，模板引擎一刀切，一股脑全量更新，对比虚拟DOM的差量更新，效率低了不少，这一次虚拟DOM胜出

综合来看，虚拟DOM在性能上并不一定占优，还得看更新范围大小。

举个极端例子，在一次更新中，整棵DOM树都变化了，这时，模板引擎明显比较占优（因为更新DOM的过程在两种方法中几乎是一样的，但是模板引擎拼接字符串比较简单易得）；
但是如果只有很小的范围更新，显然虚拟DOM是更好地选择。

最后，虚拟DOM并不是以性能作为卖点的。相比于性能上的优势，一下两点更加重要：

1. 研发效率/研发体验
2. 跨平台（本质上还是研发效率/研发体验的问题）
